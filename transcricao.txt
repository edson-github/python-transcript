oi Meu nome é Patrick Miller,
estou nuvem engenheiro esportivo aqui em AWS hoje vou falar sobre Projeto de partição com Amazon Athena A projeção é um novo recurso lançado em o in ício do ano Nesta apresentação,
abordarei o Abaixo tópicos o que são partições como carregar partições em uma tabela e Vou falar sobre partição projeção e como fazer partições de arquiteta quando Trabalhe com arquivos Partit Partição é uma técnica importante para Conjuntos de dados organizados para que eles possam consultar com eficiência dados organizados em uma estrutura baseada em valores distintos de uma ou mais chamadas Ao comprar seus dados,
você pode restringir a quantidade de dados digitalizados por cada consulta Melhorar assim o desempenho e reduzir custos Para criar uma tabela que use partições você deve defini - lo durante o grande Declaração da tabela Por exemplo,
podemos definir a raiz pasta para nossa mesa como Nome do balde mais caminho no meu caso o caminho A amostra é cometidos pelo seu mês IG depois disso você pode definir ouvido como partição por exemplo ou podemos ir fundo e definir mês e Ig ou qualquer outro Partição que você precisa para seu uso caso Na instrução CREATE TAB que você define as partições Por exemplo,
aqui estou criando uma tabela Aqui está o tipo de coluna as partições e o tipo de partições e a localização Attina quando você executa esta tabela de grade,
é vai criar uma mesa com três partições e quando você consulta a mesa que vai ler os dados Dentro deste caminho Para carregar as compras da tabela,
nós tem duas maneiras Podemos executar a tabela de reparo MSK para preveja os metadados no catálogo A tabela de reparo da MSC é considerada localização e adicione partições ao Catálogo de metadados por exemplo,
se você precisar desta tabela que você cria anteriormente você vai ver que não vai Leia qualquer data o motivo é porque Ainda não carregamos as partições depois Nós corremos a tabela de reparos da MSK vai Carregue todas as partições que temos no S3 caminho Neste momento,
então este é o caminho que Eu tenho no meu S3 Agora,
se eu tentar executar a consulta novamente Vamos ver que vai ler a data Quando uma nova partição está criando S3,
você Precisa executar o MSK Tabela de reparo para carregar as novas partições de novo 

Uma segunda opção para carregar a partição é Usando corolário de cola Rastreadores identificam automaticamente o Estrutura de particionamento do seu conjunto de dados e eles povoam os dados da escola da AWS Catálogo Depois de rastejar uma mesa,
você pode ver o partições que o rastreador ou comando da tabela de caracteres DMS Criar por Navegando para a mesa no console da AWS e na visão de escolha partições Por exemplo,
criamos esta tabela se nós ir Para colar catálogo,
esta é a mesa que nós criamos Se entrarmos na mesa Podemos ver as colunas e podemos ver Nosso script de partição projeção de partição que você pode usar Antena de projeção de partição para acelerar Processamento de consulta de altas tabelas de partição no Automatize o veterano da partição em valores de partição de projeção de partição e a localização é calculada a partir de configuração em vez de ler de um repositório como a AWS Catálogo de dados do grupo com partição Projeção que você não precisa Para executar a tabela de reparo da MSK ou criar um Google Crawler Para criar uma tabela com projeto de projeto Precisamos defini - lo na tabela de criação estado Por exemplo,
aqui eu criei uma tabela com duas partições aqui e mova - se e nas propriedades,
definimos o tipo de partição por exemplo,
tipo de ano inteiro e o faixa da partição por exemplo 2014 2016.Como você pode ver aqui Definimos o alcance para o possível valores para a coluna de partição Precisamos evitar o uso de cartas altas faixas de conhecimento Aqui vou criar uma tabela usando Projector de partição Aqui está o nome da tabela as partições dos meus dados neste caso é o ano do ano projeção é igual a verdade e depois Definimos as partições,
por exemplo aqui é o tipo inteiro e o intervalo é 2014 para 2016 e para o mês da coluna ou mês de partição nós definir que é um número inteiro e o alcance é 1 a 12.O caminho que estamos usando é este caminho aqui Depois de criar esta tabela,
podemos já Execute consultas e leia por exemplo Aqui estamos lendo aquele caminho que nós definir dentro da mesa,
se formos colar Catálogo de dados Esta é a nova tabela critic Como você pode ver agora,
não temos o Carga de partições Então você não precisa carregar as partições toda vez A próxima parada são partições de arquitetura com arquivos de pacotes Antes de pular como você pode arquitetar suas partições Precisamos entender como o arquivo Perky Funciona a tecla Apache Part é um arquivo colunar formato das colunas são agrupados por grupo de fileiras,
por exemplo,
aqui temos Grupo 0 e grupo de linha 1.Temos a coluna A dentro do grupo de linha 0 e coluna b Cada grupo de linhas é comprimido e no rodapé Temos os metadados sobre o cru grupos assim no rodapé do arquivo Temos nossos metadados relacionados a este arquivo e os grupos de fileiras,
por exemplo,
se você Execute o pacote para Para ler os grupos de linhas,
podemos ver que Para a coluna IG dentro da linha grupo 1 O mini valor é 1 e o valor máximo é 4.Podemos usar os grupos de regras de parquet para Reduza o número de partições precisam Ajuda com partições com alto cardiologia Recomendamos escrever os arquivos pedidos pela chamada que você vai usar na cláusula onde,
por exemplo Aqui temos o arquivo que não é ordenado Então,
em ambos os grupos de linhas,
temos o valor 1 aqui e aqui e o valor 2 aqui e aqui No rodapé,
podemos ver que o meio Valor para o grupo de linhas 1 é 1 e o valor máximo é 9.e o grupo de linha 2 o valor principal é 1 e o arquivo máximo é 10.Então,
se você executar uma consulta e onde a cláusula é Ig é igual a 1 Precisamos ler e descomprimir ambos grupos e se executarmos uma consulta e na palavra Cláusula é Ig é igual a 3 que não existem neste arquivo ainda precisamos descomprimir os dois grupos de linhas por causa da média e dos valores máximos na configuração do rodapé No entanto,
se o seu arquivo for ordenado por exemplo Aqui temos todo o grupo 1 com o Valor 1 e 2 Grupo 2 da linha com 4 9 e 10.no rodapé do grupo de linhas 1 o O valor principal é 1 e o valor máximo é verdadeiro para o grupo de linhas 2 O valor médio é 4 e o valor máximo é 9.Então,
se você executar uma consulta e no onde cláusula você tem ig é igual a de nós descomprimir Apenas o grupo de fileiras um Além disso,
se você executar uma consulta e a consulta e a cláusula onde Ig é igual a 3 que não existe neste arquivo Nós pulamos os dois grupos de linhas Esse é um conceito importante porque o A coluna IG tem uma alta cardinalidade e não é uma boa opção para uma partição Então aqui está o exemplo No mês 10,
temos três arquivos e O total é 10 megabytes E se você consultarmos apenas a partição 5 Temos apenas um arquivo com 21 kilobytes Eu copiei esses dados inteiros para um novo caminho e neste novo caminho Não temos o IG como partição Mas os arquivos são encomendados por IG Então,
em vez disso,
dentro do caminho que temos três arquivos e total são 9 megabytes Usando as duas tabelas que criamos antes,
por exemplo A caixa da mesa tem como ouvido de partição mova e ig se verificarmos o caminho S3 Temos apenas um arquivo com 21 kilobytes e o para a segunda tabela Caminho quase diferente que temos Partições ouvido e boca se verificarmos os arquivos dentro deste caminho Temos três arquivos com 9.9 megabytes agora Se você precisar desta tabela,
por exemplo Contagem por nome de repo na tabela onde o G é uma partição Lemos 0 9 0,
09 Kilobytes E se fizermos o mesmo com a mesa onde o IG não é uma partição Lemos 0.69 Kilobytes e não 10 megabytes E outro exemplo é se selecionarmos Apenas duas colunas,
por exemplo,
quadrinhos Edge Nesta tabela,
temos o G como partição Então,
quando executamos a consulta como você pode ver A varredura do ponto é de 1,
46 quilowatts E se fizermos o mesmo com a mesa onde IG não é uma partição é convertido,
mas não muito mais,
então este é o segundo opção que você pode usar para definir seu partições Obrigado por assistir e ter um bom dia